name: $(Date:yyyyMMdd)$(Rev:.r)

pool:
  vmImage: 'ubuntu-16.04'

steps:
- task: AzureCLI@1
  displayName: 'Azure CLI '
  inputs:
    azureSubscription: 'MTC Denver Sandbox (b0e04a4a-a321-4b66-b8fd-13715262ba3c)'
    scriptLocation: inlineScript
    failOnStandardError: true
    inlineScript: |
      # Package the helm chart and push it to ACR
      helm init --client-only
      helm package charts/mole-cloud --version $(Build.BuildNumber)
      az acr helm push -n $(acr_name) mole-cloud-$(Build.BuildNumber).tgz

